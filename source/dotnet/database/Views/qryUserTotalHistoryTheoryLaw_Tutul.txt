IF object_id('qryUserTotalHistoryTheoryLaw', 'V') IS NOT NULL

BEGIN
	DROP VIEW qryUserTotalHistoryTheoryLaw;
END
GO

CREATE VIEW [dbo].[qryUserTotalHistoryTheoryLaw]
AS
SELECT     dbo.tblAnswers.UserID, COUNT(dbo.tblAnswers.QuestionID) AS Taken, SUM(dbo.tblAnswers.Correct) AS Correct, SUM(dbo.tblAnswers.Time) 
                      AS TotalTime
FROM         dbo.tblAnswers INNER JOIN
                      dbo.tblQuestions ON dbo.tblAnswers.QuestionID = dbo.tblQuestions.QuestionID
WHERE     (dbo.tblQuestions.HistoryTheoryLaw = 1)
GROUP BY dbo.tblAnswers.UserID