IF object_id('qryUserTotalFunctionalTopics', 'V') IS NOT NULL

BEGIN
	DROP VIEW qryUserTotalFunctionalTopics;
END
GO

CREATE VIEW [dbo].[qryUserTotalFunctionalTopics]
AS
SELECT     dbo.tblAnswers.UserID, COUNT(dbo.tblAnswers.QuestionID) AS Taken, SUM(dbo.tblAnswers.Correct) AS Correct, SUM(dbo.tblAnswers.Time) 
                      AS TotalTime
FROM         dbo.tblAnswers INNER JOIN
                      dbo.tblQuestions ON dbo.tblAnswers.QuestionID = dbo.tblQuestions.QuestionID
WHERE     (dbo.tblQuestions.FunctionalTopics = 1)
GROUP BY dbo.tblAnswers.UserID